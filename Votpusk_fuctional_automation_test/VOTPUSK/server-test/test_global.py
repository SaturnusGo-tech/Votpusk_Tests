import requests
import pytest
from selenium.webdriver.common.by import By
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.ui import WebDriverWait
from selenium import webdriver


@pytest.fixture(scope="module")
def driver(request):
    options = webdriver.ChromeOptions()
    options.add_argument('--incognito')
    chrome_driver_path = "users/mercuryrucks/ChromeDriver"  # Замените на ваш путь к исполняемому файлу ChromeDriver
    driver = webdriver.Chrome(executable_path=chrome_driver_path, options=options)
    driver.maximize_window()
    yield driver
    driver.quit()


@pytest.mark.parametrize("tracking_number", [
    "060301680710104", "990101011404183", "060301680575272", "650159679", "CLFOX001010046277425",
    "CLFOX000520018943806", "CLFOX001700085108240", "JCV0601124609YQ", "1100006020", "2070013306", "2070013301",
    "00GX1VW4", "LS578008765CH", "ES10019316039290001010001D0N", "ES10019391975550001010001D0N", "UPAAD000000040501506",
    "UPAAB000000458011944", "UPAAD000000056761069", "UPAAB000000465873830", "UPAAD000000056761069", "AZ060703369JE",
    "RK102963818JE", "RR958479995KG", "RZ902284185KG", "AT0001082082", "LC659884395CN", "UG513294704YP",
    "PR204381115YP", "VR446369067YP", "UG467571805YP", "FARXP4349733161YQ", "FAREX2207035942YQ", "275998928612",
    "608506463200", "RZ093437697MH", "ML141351446MH", "UN019166036MH", "13289301445844", "14082397346", "37817434616",
    "PA0013968094", "712105655295", "006484146690", "006484146620", "006581109426", "JVGL06176002000386633547",
    "483220615175323", "НМ000112792", "НМ000112792", "3317806", "250624982", "250626974", "521347699", "5P34C23657205",
    "H1000810945815302081", "4209802992612927005485000022298849", "507285003084000013601191",
    "505750042415000013608000", "158271900021244343601014", "605945780744000013606792", "N21626709", "6698-7414-FAYQ",
    "0897-7468-KLAJ", "1313-2704-WSCR", "9901-9943-QBZY", "S97R-3FVK-ZP10", "ZRZ42386698", "MP0013117019",
    "NZ0004374342", "BN5112965159", "QH2001517801", "EXP20877509", "IHB5159403710", "RM020091385MX", "RP449823564MX",
    "6063001922", "IEFA1575942542F4C6", "IEFA1575942542F4C6", "PU281211986066SG", "7002366908", "8105513357",
    "8105390615", "8105513357", "EHE065328625MY", "6651335854", "5173144233", "CE386937642IE", "RY223702625IE",
    "3867500000048789179", "854270546", "259-631805", "RS928685225DE", "HKAWL4PLEG3KO1K92", "CPWPS2000002165",
    "CPB5TNZ2216107", "CD018715161RU", "025322780", "V03164E1253881", "V00060E6680379", "CC438890316NZ",
    "STCPA000002004134713", "STCPA000002015049825", "MPEN188396", "MPEN188396", "3A5V572441786", "3A5V529947415",
    "10004136534191", "3A5V610198575", "00794210305216584522", "92748902410402000311591640", "QP923794630GB",
    "00794210305218917717", "61131711492", "61131711492", "CM212178006FR", "6A23552758168", "8U01866442478",
    "006051496333", "006051496333", "006051496399", "FMPP0405321519", "SP021490031952023221", "SP001460031542282665",
    "LX242920433CN", "CP259372356PL", "CP238819285PL", "LT416268189NL", "00559007738078005837", "00559007738213491686",
    "ESKIX51003844791", "ECMOF00000571550", "ECAMZ01000104203", "APECHUS203005191", "PCLP0052180737397303201",
    "RH969059067AT", "1LSCXLZ000V0PNK", "1LSCZ5A000UYESC", "1LSCYG5000VG0QW", "1LSCYG5000Z08QT", "712102085041",
    "000511583741", "000342388336", "SFCAA0037373423YQ", "SFCAA0037781181YQ", "SFCAA0040055300YQ", "LZ044500518DK",
    "128185344", "128185344", "44538407-1", "712103909775", "006481328195", "056450540554", "712103703290",
    "006581108337", "710292739376", "0123028215783336", "9017011200096436", "051144752805", "211144948334",
    "NY0003796637", "9K0001050712", "MP0014272221", "T001PA0034540457", "H02SRA0000003476", "H01V8A0003743919",
    "EFS1002608329", "34390748346", "1970460682", "88813102867", "WS42078749", "112030116002848", "217045911451",
    "290306429858", "290768329617", "LD507547378HK", "RT301295790HK", "1813901260008981", "1825103230005565",
    "ABC0200875", "Z0521765Z", "AS952401088CN", "AEIIPLA0007877193", "AEIIPNJ0030422704", "AEIIPNJ0031281782", "9911",
    "LSHP23060213", "NET69837835", "CG040949717GH", "CG004073564IS", "LA000637804IS", "CG004105925IS", "2020006161",
    "2020006161", "S5XNQJ", "S9BRW35", "SPQXVD6", "123", "WHTUA0000041267YQ", "LL426441071CN", "EXBRU0000043185YQ",
    "EXBRU0000040023YQ", "6022640013303", "RA128791390LV", "CP052071308KZ", "I10000039478", "1A0011315172",
    "CCL0001106259", "9K0001050712", "NY0004834473", "TP20073014938", "TP10015938482", "TP10016907291", "RV062195253HK",
    "KP189513523521CN", "SQ-002726633135", "CA000060551LY", "ES10019215828590001010001E0N",
    "EE10017366858690001020003B0N", "ES10019391392130001010001C0N", "FRI001RS000002", "POL031RE000014",
    "POL004LE000303", "CPAK2HC0248947", "ICLS3992730", "DPK364084244303", "SY14055085900", "EWSUA1903250168YQ",
    "EWSHK9910199592YQ", "TWN00430636", "AU1SPM050163", "SPD22070903557671AU", "52000166708", "57100625941",
    "JNTIL0300063694YQ", "JNTCU2000600198YQ", "JNTRU1500000386YQ", "14082580680080", "91111596367", "LC566539063CN",
    "RA644000001RU", "14084576029941", "210290090485", "621530300495", "7916641", "23180019", "XBPDN0049610",
    "50121402", "77703370511", "МН000062159", "НМ000112792", "BUFZA2090051530YQ", "BUFZA1070031130YQ",
    "BUFZA4060630606YQ", "GFWR20KBE34D7HWS", "87RR32686488A040", "ML5610933", "PPT6HZVRNKAYF",
    "521000011236060016805331", "SM704944196256478227", "H01XRA0003121458", "ECSKA159932", "55500058296", "55535630334",
    "RWM001453023", "RR833849984JO", "RR242902695JO", "00340434499303310815", "CJPOS7060203528YQ",
    "1548876526039212033", "00057151271447415673", "RO818000087PA", "LD176628147BE", "EE817260488BE", "1230402316",
    "MYGUT7770027366", "DA000135802GR", "DA000255345GR", "31671188776", "LB299052275SE", "FMG288791901000935000",
    "5110722", "RR007230326MN", "RR007579805MN", "92144903245036910026721257", "400476000895", "6676545538717",
    "AEWH0005055504RU4", "CNL0000687153", "PGSD00000558", "PGSD00000558", "68219186", "496-2135337-94022",
    "496-036668080", "RB092022225SG", "RR219991081AL", "00081454351241", "00000000053404", "00401858", "LA282014185EE",
    "LC055678940CN", "AECD0001807504RU", "LD404324056BE", "ALI52177101897050", "CN0000529427RU8", "RLCJ00258846",
    "2091Y004219919", "OTNKZ3022108973YQ", "313238340579660017", "PX1095232805", "ECSCCA0014728626", "6755045093511",
    "RU785601912NL", "1C8637G016721", "RC260989295IT", "99990006858778", "99990000202329", "99990000182307",
    "99990000185402", "99990000202329", "1115123", "210158800", "RF006896458LK", "9274899990995431341306",
    "9400109201973505632570", "GM545115385000825153", "AT0001075950", "CE590527468EE", "RO300586663EE", "RR236929464EE",
    "RO300586663EE", "CH174446671US", "TWAL564811", "EM082980995DK", "RR223190820DK", "00370730257942256677",
    "CP600181131MO", "BY080009242988", "BY080020859176", "000233725", "296309114", "WS764182", "TYZRB0001548168YQ",
    "TYZRB0003823178YQ", "TYZPH0015011363YQ", "21-01321018731", "23704392", "23791614", "2103681089962", "505393321426",
    "RC045714925MK", "pl-005121-S11640", "pl-080735-7125", "pl-000193-1584-vtm929", "pl-005167-000Т-031622",
    "UNA0390570CN", "UNA0258466CN", "UNT0378455CN", "04868618-0170-1", "400081201890000", "600078387726000",
    "RI067577064UA", "RI065536844UA", "JSHUA0000044601YQ", "JSHRS0000000346YQ", "JSHRS0000000002YQ", "RB120328416MD",
    "RB120328416MD", "RC330011827MD", "DP8000847186RC", "40624493", "UT096870916NL", "H1018660452486101043",
    "LP521102701CN", "4PX3000198230101CN", "RI310935289BG", "RI325086796BG", "CH126899650AU", "SLPU00032513RU",
    "RP1287257", "EG714124256KR", "LK073103726KR", "RW20734069", "QFLQQ3000054686YQ", "ZVT35873080", "210290090485",
    "SHP1499738", "44436922-0", "alp2584930", "0000158793364", "0000262178509", "AGE124292997", "KIX35622",
    "AZMX242916847", "62058", "TSE2827713", "UK005021339NO", "370722151259330246", "ДЖЗКРД0101694603", "0111100324",
    "LT498323454NL", "LT498323454NL", "RF795309258SK", "1900445", "СП-п284923", "КРК-013031", "4643422", "6459575",
    "M1621635863", "BA620593575", "R3620714868", "RA179204425LV", "ETSSD1027127932YQ", "HJYTE2123586067YQ",
    "HJYTE7758381311YQ", "HJYTE2124840389YQ", "546579717207170014", "11410047604570", "760064823", "P5000152073074550",
    "RR000710781OM", "RR019281798OM", "EE333516665NG", "5557565114", "1200164116", "3206725118", "3063603114",
    "3234735115", "179303175117", "RX130359700JP", "RX131715314JP", "RX136369444JP", "SPON655159", "SPON263820",
    "SPON263821", "00364300487146504980", "RG890001352BE", "LD270562604BE", "RA137997539LV", "CU001283966AM",
    "RF103420101AM", "99990026978669", "UNA0390570CN", "RLBU00018988", "RLAL00264895", "RLJ01842912", "RLT00450487E",
    "RLT00222487E", "RLC00622614", "RLC00622111", "RLC00454614", "RLH00817484", "RLH00855484", "RLH01127484",
    "RLZ00197312", "RLM00179303", "RLBS00026355", "RLV01582270", "RLO00239510E", "CN0003485288RU9", "RR952193178CZ",
    "RR276202785CZ", "RR402883636CZ", "90356309333", "QR21309472", "QR13278702", "QR17241473", "QR13376544",
    "RE000776995RU", "QR17576555", "CGSBY0100000204YQ", "CGSRU0500007905YQ", "CGSRU0500030290YQ", "LT498323454NL",
    "RF795309258SK", "1900445", "СП-п284923", "КРК-013031", "4643422", "6459575", "M1621635863", "BA620593575",
    "R3620714868", "RA179204425LV", "ETSSD1027127932YQ", "HJYTE2123586067YQ", "HJYTE7758381311YQ", "HJYTE2124840389YQ",
    "546579717207170014", "11410047604570", "760064823", "P5000152073074550", "RR000710781OM", "RR019281798OM",
    "EE333516665NG", "5557565114", "1200164116", "3206725118", "3063603114", "3234735115", "179303175117",
    "RX130359700JP", "RX131715314JP", "RX136369444JP", "SPON655159", "SPON263820", "SPON263821", "00364300487146504980",
    "RG890001352BE", "LD270562604BE", "RA137997539LV", "CU001283966AM", "RF103420101AM", "99990026978669",
    "UNA0390570CN", "RLBU00018988", "RLAL00264895", "RLJ01842912", "RLT00450487E", "RLT00222487E", "RLC00622614",
    "RLC00622111", "RLC00454614", "RLH00817484", "RLH00855484", "RLH01127484", "RLZ00197312", "RLM00179303",
    "RLBS00026355", "RLV01582270", "RLO00239510E", "CN0003485288RU9", "RR952193178CZ", "RR276202785CZ", "RR402883636CZ",
    "90356309333", "QR21309472", "QR13278702", "QR17241473", "QR13376544", "RE000776995RU", "QR17576555",
    "CGSBY0100000204YQ", "CGSRU0500007905YQ", "CGSRU0500030290YQ", "CGSRU0500070323YQ", "CGSRU0500079408YQ",
    "84770210884", "84829755102", "84762898194", "1098500603", "2188356773", "EFS1003510959", "EFS1003516354",
    "ANTPK1423310425YQ", "ANTPK3905097279YQ", "ANTLK1431459056YQ", "48312519", "67877567", "RA141394490LV",
    "SB051168699LV", "BP123617964BY", "RR397814410BY", "RR397814410BY", "SB035719296EE", "RR538536667BY",
    "RR553786945BY", "BV199666951BY", "VV412178576BY", "LA112630593BY", "969-415923", "RQ031458710CY", "CE002807466CY",
    "LTN135591411N1", "LTN27654545N1", "LTN89174294N1", "323211926000001714036030", "LTN207121532N1", "LDLBUS025032357",
    "3020-5273", "0000000000000000", "6163774380", "7000600225694009", "HKG0972225", "300444", "LS574189320CH",
    "LS578008765CH", "LB012589425EE", "LS578008765CH", "1239327770", "1274287507", "1415807987", "CN0003485288RU9",
    "2702223-973713", "E0008905144", "A-024646858", "CP029153541AZ", "RR913088725BA", "RR055897653BA", "CH211138014ET",
    "EE500780755MV", "RS928685225DE", "CH174446671US", "RB031265351SG", "EE201755754BN", "RB206563402SG",
    "RB206563402SG", "RH140661923GB", "RS479034865NL", "RH286527931CN", "RP882908882CN", "UV552661192UZ",
    "RR042590626BW", "4014248267375405", "4007854232853405", "2003961281466514", "RF930041215HR", "LT662934070NL",
    "RY538580590CN", "LT679205407NL", "EM118683360HR", "CE281407557HR", "RG233269855HR", "RA140826843LV",
    "RE266061323GR", "RB040360470SG", "RF425221539SG", "RR403236956DE", "RA182530889LV", "RR001520890GE",
    "SA035553693LV", "MH297799873FI", "MH317111410FI", "MH317752651FI", "ANN7640GB44551467901", "CAP0460NL08324054301",
    "CAP0460NL49813783701", "CRC0067GB00647453701", "CM542291427DE", "EE196691095PH", "RB759952345SG", "UW365634941CN",
    "RB916799075SG", "RB018805750SG", "RR046284913SV", "RR046284913SV", "RB098548641SG", "RC205920156MY",
    "RV941469416CN", "RR027167517SA", "RB984637125SG", "ES001633565SA", "CE021262333SA", "LS060502225NL",
    "LS163846863NL", "LS391727933NL", "RU894515273NL", "UD675148182NL", "LT498323454NL", "RU999147281NL",
    "RR549444989UY", "RA872428317IT", "RW102191668SG", "RM119853343MX", "OTNBY2072519749YQ", "OTNUA1112914336YQ",
    "OTNKZ3022108973YQ", "ABC46914947", "194822738530", "AE7FD8EC", "00001776546", "00002124098", "00002459951",
    "00002461402", "1859", "93856", "42086451", "69371641", "69496788", "69491100", "69505601", "69540703",
    "RE289772128LT", "LP211059339LT", "LI217032507LT", "ES131D83D1015AB", "ES365L53P9117AB", "IT2022COM0000465813",
    "IT2022COM0000465106", "H0358812", "HD0157142", "JY233U100005002358", "0082800082809703252958", "RP26271586",
    "SLPU00390063RU", "511412059", "516721879", "598896536", "I-023857743", "520772108", "ПСПДВВЖ-1/1711",
    "749947586573", "990447241672", "400081201890000", "600078387726000", "10224359180", "10224407266", "LX523427541ES",
    "RF270771390ES", "352248", "228349", "3927930749", "I-024041575", "2702523-919006", "RU230409-874257", "I-024589988"

])
def test_tracking_number(driver, tracking_number):
    # Navigate to the tracking site
    driver.get("https://track.global/ru")

    # Wait for the input form and the "Find" button to become visible
    input_field = WebDriverWait(driver, 10).until(
        EC.visibility_of_element_located((By.XPATH, '/html/body/main/section/section[1]/div/div['
                                                    '1]/div/div/form/div/div[1]/label/input'))
    )
    input_field.send_keys(tracking_number)

    submit_button = WebDriverWait(driver, 10).until(
        EC.visibility_of_element_located((By.CLASS_NAME, "top__search-btn"))
    )
    submit_button.click()

    # Wait for the tracking information or "not found" message to become visible
    try:
        tracking_info = WebDriverWait(driver, 10).until(
            EC.visibility_of_element_located(
                (By.XPATH, '//*[@id="widgetContentMain"]/section/div/div/div[2]'))
        )
        tracking_info_text = tracking_info.text
        slack_webhook_url1 = "https://hooks.slack.com/services/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"
        requests.post(slack_webhook_url1,
                      json={
                          "text": f"Tracking number: {tracking_number}\nTracking information: {tracking_info_text}"})

    except:
        not_found_message = WebDriverWait(driver, 10).until(
            EC.visibility_of_element_located((By.XPATH, '//*[@id="widgetContentMain"]/section/div/h3'))
        )
        not_found_message_text = not_found_message.text
        alternate_site_url = f"https://www.tracktry.com/track{tracking_number}"
        requests.get(alternate_site_url)
        slack_webhook_url2 = "https://hooks.slack.com/services/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"
        requests.post(slack_webhook_url2,
                      json={"text": f"Tracking number: {tracking_number}\nInformation :"
                                    f"Not found on research site {alternate_site_url}\nNot found :"
                                    f"{not_found_message_text}"})
